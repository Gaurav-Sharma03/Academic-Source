{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Shivam\\\\Desktop\\\\Academic-Source\\\\frontend\\\\src\\\\components\\\\ProtectedRoute.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { jwtDecode } from 'jwt-decode'; // âœ… Correct import\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProtectedRoute = ({\n  children,\n  allowedRoles\n}) => {\n  _s();\n  const [valid, setValid] = useState(null); // null = loading\n  const token = localStorage.getItem('token');\n  const role = localStorage.getItem('role');\n  useEffect(() => {\n    if (!token || !role || !allowedRoles.includes(role)) {\n      setValid(false);\n      return;\n    }\n    try {\n      const decoded = jwtDecode(token);\n      if (decoded.exp * 1000 < Date.now()) {\n        localStorage.clear();\n        setValid(false);\n      } else {\n        setValid(true);\n      }\n    } catch (err) {\n      console.error('JWT decode error:', err);\n      localStorage.clear();\n      setValid(false);\n    }\n  }, [token, role]);\n  if (valid === null) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center py-20 text-blue-500\",\n      children: \"\\uD83D\\uDD12 Verifying token...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 12\n    }, this);\n  }\n  return valid ? children : /*#__PURE__*/_jsxDEV(Navigate, {\n    to: \"/login\",\n    replace: true\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 29\n  }, this);\n};\n_s(ProtectedRoute, \"RcYyrT0G+awbm5EQnpcPz90N5y4=\");\n_c = ProtectedRoute;\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["React","useEffect","useState","Navigate","jwtDecode","jsxDEV","_jsxDEV","ProtectedRoute","children","allowedRoles","_s","valid","setValid","token","localStorage","getItem","role","includes","decoded","exp","Date","now","clear","err","console","error","className","fileName","_jsxFileName","lineNumber","columnNumber","to","replace","_c","$RefreshReg$"],"sources":["C:/Users/Shivam/Desktop/Academic-Source/frontend/src/components/ProtectedRoute.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Navigate } from 'react-router-dom';\r\nimport { jwtDecode } from 'jwt-decode'; // âœ… Correct import\r\n\r\nconst ProtectedRoute = ({ children, allowedRoles }) => {\r\n  const [valid, setValid] = useState(null); // null = loading\r\n  const token = localStorage.getItem('token');\r\n  const role = localStorage.getItem('role');\r\n\r\n  useEffect(() => {\r\n    if (!token || !role || !allowedRoles.includes(role)) {\r\n      setValid(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const decoded = jwtDecode(token);\r\n      if (decoded.exp * 1000 < Date.now()) {\r\n        localStorage.clear();\r\n        setValid(false);\r\n      } else {\r\n        setValid(true);\r\n      }\r\n    } catch (err) {\r\n      console.error('JWT decode error:', err);\r\n      localStorage.clear();\r\n      setValid(false);\r\n    }\r\n  }, [token, role]);\r\n\r\n  if (valid === null) {\r\n    return <div className=\"text-center py-20 text-blue-500\">ðŸ”’ Verifying token...</div>;\r\n  }\r\n\r\n  return valid ? children : <Navigate to=\"/login\" replace />;\r\n};\r\n\r\nexport default ProtectedRoute;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,QAAQ,QAAQ,kBAAkB;AAC3C,SAASC,SAAS,QAAQ,YAAY,CAAC,CAAC;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAExC,MAAMC,cAAc,GAAGA,CAAC;EAAEC,QAAQ;EAAEC;AAAa,CAAC,KAAK;EAAAC,EAAA;EACrD,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGV,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;EAC1C,MAAMW,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,MAAMC,IAAI,GAAGF,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;EAEzCd,SAAS,CAAC,MAAM;IACd,IAAI,CAACY,KAAK,IAAI,CAACG,IAAI,IAAI,CAACP,YAAY,CAACQ,QAAQ,CAACD,IAAI,CAAC,EAAE;MACnDJ,QAAQ,CAAC,KAAK,CAAC;MACf;IACF;IAEA,IAAI;MACF,MAAMM,OAAO,GAAGd,SAAS,CAACS,KAAK,CAAC;MAChC,IAAIK,OAAO,CAACC,GAAG,GAAG,IAAI,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;QACnCP,YAAY,CAACQ,KAAK,CAAC,CAAC;QACpBV,QAAQ,CAAC,KAAK,CAAC;MACjB,CAAC,MAAM;QACLA,QAAQ,CAAC,IAAI,CAAC;MAChB;IACF,CAAC,CAAC,OAAOW,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,mBAAmB,EAAEF,GAAG,CAAC;MACvCT,YAAY,CAACQ,KAAK,CAAC,CAAC;MACpBV,QAAQ,CAAC,KAAK,CAAC;IACjB;EACF,CAAC,EAAE,CAACC,KAAK,EAAEG,IAAI,CAAC,CAAC;EAEjB,IAAIL,KAAK,KAAK,IAAI,EAAE;IAClB,oBAAOL,OAAA;MAAKoB,SAAS,EAAC,iCAAiC;MAAAlB,QAAA,EAAC;IAAqB;MAAAmB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;EACrF;EAEA,OAAOnB,KAAK,GAAGH,QAAQ,gBAAGF,OAAA,CAACH,QAAQ;IAAC4B,EAAE,EAAC,QAAQ;IAACC,OAAO;EAAA;IAAAL,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;AAC5D,CAAC;AAACpB,EAAA,CA/BIH,cAAc;AAAA0B,EAAA,GAAd1B,cAAc;AAiCpB,eAAeA,cAAc;AAAC,IAAA0B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}