{"ast":null,"code":"var _jsxFileName = \"D:\\\\Academic Resource Management System\\\\frontend\\\\src\\\\components\\\\ProtectedRoute.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport jwt_decode from 'jwt-decode';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProtectedRoute = ({\n  children,\n  allowedRoles\n}) => {\n  _s();\n  const [valid, setValid] = useState(false);\n  const token = localStorage.getItem('token');\n  const role = localStorage.getItem('role');\n  useEffect(() => {\n    if (!token || !role || !allowedRoles.includes(role)) {\n      setValid(false);\n      return;\n    }\n    try {\n      const decoded = jwt_decode(token);\n      if (decoded.exp * 1000 < Date.now()) {\n        localStorage.clear();\n        setValid(false);\n      } else {\n        setValid(true);\n      }\n    } catch (err) {\n      localStorage.clear();\n      setValid(false);\n    }\n  }, [token, role]);\n  return valid ? children : /*#__PURE__*/_jsxDEV(Navigate, {\n    to: \"/login\",\n    replace: true\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 30,\n    columnNumber: 29\n  }, this);\n};\n_s(ProtectedRoute, \"s2BkWX/tapHuHfh22OeWDCUmNC4=\");\n_c = ProtectedRoute;\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["React","useEffect","useState","Navigate","jwt_decode","jsxDEV","_jsxDEV","ProtectedRoute","children","allowedRoles","_s","valid","setValid","token","localStorage","getItem","role","includes","decoded","exp","Date","now","clear","err","to","replace","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/Academic Resource Management System/frontend/src/components/ProtectedRoute.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Navigate } from 'react-router-dom';\r\nimport jwt_decode from 'jwt-decode';\r\n\r\nconst ProtectedRoute = ({ children, allowedRoles }) => {\r\n  const [valid, setValid] = useState(false);\r\n  const token = localStorage.getItem('token');\r\n  const role = localStorage.getItem('role');\r\n\r\n  useEffect(() => {\r\n    if (!token || !role || !allowedRoles.includes(role)) {\r\n      setValid(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const decoded = jwt_decode(token);\r\n      if (decoded.exp * 1000 < Date.now()) {\r\n        localStorage.clear();\r\n        setValid(false);\r\n      } else {\r\n        setValid(true);\r\n      }\r\n    } catch (err) {\r\n      localStorage.clear();\r\n      setValid(false);\r\n    }\r\n  }, [token, role]);\r\n\r\n  return valid ? children : <Navigate to=\"/login\" replace />;\r\n};\r\n\r\nexport default ProtectedRoute;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,QAAQ,QAAQ,kBAAkB;AAC3C,OAAOC,UAAU,MAAM,YAAY;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEpC,MAAMC,cAAc,GAAGA,CAAC;EAAEC,QAAQ;EAAEC;AAAa,CAAC,KAAK;EAAAC,EAAA;EACrD,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGV,QAAQ,CAAC,KAAK,CAAC;EACzC,MAAMW,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,MAAMC,IAAI,GAAGF,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;EAEzCd,SAAS,CAAC,MAAM;IACd,IAAI,CAACY,KAAK,IAAI,CAACG,IAAI,IAAI,CAACP,YAAY,CAACQ,QAAQ,CAACD,IAAI,CAAC,EAAE;MACnDJ,QAAQ,CAAC,KAAK,CAAC;MACf;IACF;IAEA,IAAI;MACF,MAAMM,OAAO,GAAGd,UAAU,CAACS,KAAK,CAAC;MACjC,IAAIK,OAAO,CAACC,GAAG,GAAG,IAAI,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;QACnCP,YAAY,CAACQ,KAAK,CAAC,CAAC;QACpBV,QAAQ,CAAC,KAAK,CAAC;MACjB,CAAC,MAAM;QACLA,QAAQ,CAAC,IAAI,CAAC;MAChB;IACF,CAAC,CAAC,OAAOW,GAAG,EAAE;MACZT,YAAY,CAACQ,KAAK,CAAC,CAAC;MACpBV,QAAQ,CAAC,KAAK,CAAC;IACjB;EACF,CAAC,EAAE,CAACC,KAAK,EAAEG,IAAI,CAAC,CAAC;EAEjB,OAAOL,KAAK,GAAGH,QAAQ,gBAAGF,OAAA,CAACH,QAAQ;IAACqB,EAAE,EAAC,QAAQ;IAACC,OAAO;EAAA;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;AAC5D,CAAC;AAACnB,EAAA,CA1BIH,cAAc;AAAAuB,EAAA,GAAdvB,cAAc;AA4BpB,eAAeA,cAAc;AAAC,IAAAuB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}